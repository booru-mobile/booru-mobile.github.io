(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{24:function(e,t,n){e.exports=n(35)},29:function(e,t,n){},30:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),u=n(19),i=n.n(u),o=(n(29),n(11)),c=n(3),s=n(15),l=n(23);n(30);function m(e){var t=e.client,n=r.a.useState({searchQuery:"",searchResults:[],loading:!1}),a=Object(s.a)(n,2),u=a[0],i=a[1];function o(e){i(function(t){return Object.assign({},t,e)})}var c=r.a.useRef();var m=Object(l.a)(),h=Object(s.a)(m,2),f=h[0];if(h[1]&&!u.loading&&u.searchResults.length>0){o({loading:!0});var p=u.searchResults[u.searchResults.length-1].id;fetch(t.getNextResults(u.searchQuery,p)).then(function(e){return e.json()}).then(function(e){i(function(t){return Object.assign({},t,{searchResults:t.searchResults.concat(e.filter(function(e){return e.file_url}))})}),setTimeout(function(){return o({loading:!1})},300)})}return r.a.createElement("div",{id:"search_page"},r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),o({loading:!0}),fetch(t.getInitialResults(u.searchQuery)).then(function(e){return e.json()}).then(function(e){o({searchResults:e.filter(function(e){return e.file_url})}),setTimeout(function(){return o({loading:!1})},300)})}},r.a.createElement("input",{type:"text",value:u.searchQuery,onChange:function(e){o({searchQuery:e.target.value})}}),r.a.createElement("input",{type:"submit",value:"Search"}),r.a.createElement("button",{type:"button",onClick:function(){return c.current.scrollTo(0,0)}},"Back to top")),r.a.createElement("section",{ref:c},r.a.createElement("ol",null,u.searchResults.filter(function(e){var t=e.source;return!t||!t.includes("pximg")}).map(function(e){var t=e.large_file_url,n=e.file_url,a=e.description;return r.a.createElement("li",{key:t||n},r.a.createElement("img",{src:t||n,alt:a}))}),u.loading&&r.a.createElement("li",{key:"spinner"},"Loading...")),r.a.createElement("div",{ref:f})))}var h=n(4),f=n(5),p=n(9),g=n(8),b=n(10),d=n(6),y=n.n(d),j=function(){function e(){Object(h.a)(this,e),this.apiBaseUrl="https://booru-mobile-proxy.herokuapp.com",this.pageSize=25}return Object(f.a)(e,[{key:"getInitialResults",value:function(e){}},{key:"getNextResults",value:function(e,t){}},{key:"commonQueryParams",get:function(){return{limit:this.pageSize,_client:"booru-mobile/1.0"}}}]),e}(),E=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"getInitialResults",value:function(e){return y()(this.apiBaseUrl,{path:"/danbooru/posts.json",queryParams:Object.assign(this.commonQueryParams,{page:1,tags:e})})}},{key:"getNextResults",value:function(e,t){return y()(this.apiBaseUrl,{path:"/danbooru/posts.json",queryParams:Object.assign(this.commonQueryParams,{page:"b".concat(t),tags:e})})}}]),t}(j),v=function(e){function t(){return Object(h.a)(this,t),Object(p.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(f.a)(t,[{key:"getInitialResults",value:function(e){return y()(this.apiBaseUrl,{path:"/e621/post/index.json",queryParams:Object.assign(this.commonQueryParams,{tags:e})})}},{key:"getNextResults",value:function(e,t){return y()(this.apiBaseUrl,{path:"/e621/post/index.json",queryParams:Object.assign(this.commonQueryParams,{before_id:t,tags:e})})}}]),t}(j);function O(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"booru mobile"),r.a.createElement("p",null,r.a.createElement(o.b,{to:"/e621"},"e621")),r.a.createElement("p",null,r.a.createElement(o.b,{to:"/danbooru"},"danbooru")))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(function(){return r.a.createElement(o.a,null,r.a.createElement(c.a,{exact:!0,path:"/",component:O}),r.a.createElement(c.a,{path:"/e621",render:function(){return r.a.createElement(m,{client:new v})}}),r.a.createElement(c.a,{path:"/danbooru",render:function(){return r.a.createElement(m,{client:new E})}}))},null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[24,1,2]]]);
//# sourceMappingURL=main.dda814da.chunk.js.map